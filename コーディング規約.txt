000000*****************************************************************
000000* コーディング規約（PGM001 利息計算・決済処理用）
000000*---------------------------------------------------------------*
000000* UPDATE :
000000*   2026/01/20 : 初版作成（PGM001 SRC準拠）
000000*---------------------------------------------------------------*
000000* プログラムID : PGM001
000000*---------------------------------------------------------------*
000000* 1. 目的
000000*---------------------------------------------------------------*
000000* 本ドキュメントは、PGM001（利息計算・満期決済処理）
000000* プログラムにおける COBOL / DB2 のコーディング規約を
000000* 明確に定義し、以下を目的とする。
000000*
000000*   ・可読性の向上
000000*   ・保守性の確保
000000*   ・チーム内での実装統一
000000*   ・SRC レビューおよび品質保証の効率化
000000*---------------------------------------------------------------*
000000* 2. 全体構成規約
000000*---------------------------------------------------------------*
000000* ・COBOL 標準構成に従い、以下の DIVISION を使用する
000000*
000000*   - IDENTIFICATION DIVISION
000000*   - ENVIRONMENT DIVISION
000000*   - DATA DIVISION
000000*     ・WORKING-STORAGE SECTION
000000*     ・LINKAGE SECTION
000000*   - PROCEDURE DIVISION
000000*
000000* ・各処理単位は SECTION 単位で定義する
000000* ・SECTION 名は処理内容を明確に表す名称とする
000000*
000000*   例：
000000*     INIT-VARIABLE
000000*     HANDLE-JCL-PARAM
000000*     FUNCTION-001
000000*     FUNCTION-002
000000*---------------------------------------------------------------*
000000* 3. コメント記述規約
000000*---------------------------------------------------------------*
000000* ・コメント行は必ず「*」から開始する
000000* ・処理ブロックの開始前に NOTE コメントを記述する
000000*
000000*   例：
000000*   *-----------------------------------------------------------*
000000*   * NOTE: 利息計算処理（FUN_001）
000000*   *-----------------------------------------------------------*
000000*
000000* ・業務ロジックは日本語コメントで明確に説明する
000000* ・SQL 処理、ABEND 処理は必ずコメントを付与する
000000*---------------------------------------------------------------*
000000* 4. 命名規約
000000*---------------------------------------------------------------*
000000* 【変数プレフィックス】
000000*   WS-   : WORKING-STORAGE 変数
000000*   HV-   : SQL ホスト変数
000000*   CST-  : 定数（CONSTANT）
000000*   AS-   : DB_ACCOUNT_SAVINGS（DCLGEN）
000000*   AB-   : DB_ACCOUNT_BALANCE（DCLGEN）
000000*   LNK-  : LINKAGE SECTION 変数
000000*
000000* 【SECTION 命名】
000000*   - 動詞 + 対象 + 機能
000000*
000000*   例：
000000*     FETCH-AND-CALCULATE
000000*     UPDATE-ACCOUNT-BALANCE
000000*---------------------------------------------------------------*
000000* 5. 初期化規約
000000*---------------------------------------------------------------*
000000* ・プログラム開始時に必ず INIT-VARIABLE を実行する
000000* ・INITIALIZE 文を使用し、個別 MOVE は極力避ける
000000*
000000*   例：
000000*     INITIALIZE WS-VARIABLES
000000*     INITIALIZE HV-VARIABLES
000000*---------------------------------------------------------------*
000000* 6. JCL パラメータ処理規約
000000*---------------------------------------------------------------*
000000* ・JCL パラメータは LINKAGE SECTION で受け取る
000000* ・UNSTRING により FUNC / ACC_ID / DATE を分解する
000000* ・入力チェックは以下の順で実施する
000000*
000000*   1) FUNCTION パラメータチェック
000000*   2) ACC_ID 数値チェック
000000*   3) DATE 数値・過去日チェック
000000*
000000* ・不正時は DISPLAY 後 STOP RUN
000000*---------------------------------------------------------------*
000000* 7. DB2 / SQL コーディング規約
000000*---------------------------------------------------------------*
000000* ・すべての SQL 文は EXEC SQL ～ END-EXEC を使用する
000000* ・SQL 実行後は必ず SQLCODE を判定する
000000*
000000*   - SQLCODE = 0   ：正常
000000*   - SQLCODE = 100 ：FETCH 終了
000000*   - SQLCODE < 0   ：異常（ABEND）
000000*
000000* ・カーソル処理は以下の順序を厳守する
000000*
000000*   DECLARE → OPEN → FETCH → CLOSE
000000*---------------------------------------------------------------*
000000* 8. カーソル処理規約
000000*---------------------------------------------------------------*
000000* ・FETCH は PERFORM UNTIL EOF フラグ方式を使用する
000000* ・EOF フラグは 'Y' / 'N' で管理する
000000*
000000*   例：
000000*     PERFORM UNTIL CST-EOF-CRS1 = 'Y'
000000*         PERFORM FETCH-AND-CALCULATE
000000*     END-PERFORM
000000*---------------------------------------------------------------*
000000* 9. 利息計算ロジック規約
000000*---------------------------------------------------------------*
000000* ・計算式は COMPUTE 文を使用する
000000* ・マジックナンバーは使用せず、定数定義を利用する
000000*
000000*   INTEREST =
000000*     MONEY_ROOT × INTEREST_RATE × DAYS / 365
000000*
000000* ・定期／非定期判定は SAVING_TYPE により分岐する
000000*---------------------------------------------------------------*
000000* 10. 更新処理規約
000000*---------------------------------------------------------------*
000000* ・DB 更新処理は FUNCTION-002 のみで実施する
000000* ・更新対象
000000*   - DB_ACCOUNT_BALANCE
000000*   - DB_ACCOUNT_SAVINGS
000000*
000000* ・UPDATE 成功後のみ COMMIT を実行する
000000*---------------------------------------------------------------*
000000* 11. COMMIT / ROLLBACK 規約
000000*---------------------------------------------------------------*
000000* ・COMMIT は COMMIT-DATA SECTION に集約する
000000* ・ROLLBACK は ABEND-PROGRAM 内のみで実行する
000000* ・FUN_001 では COMMIT を行わない
000000*---------------------------------------------------------------*
000000* 12. ABEND 処理規約
000000*---------------------------------------------------------------*
000000* ・SQLCODE < 0 の場合は ABEND-PROGRAM を呼出す
000000* ・以下の情報を必ず設定する
000000*
000000*   - CST-ABEND-BREAKPOINT
000000*   - CST-ABEND-DETAIL
000000*
000000* ・ABEND-PROGRAM 内で
000000*   - エラーメッセージ出力
000000*   - ROLLBACK
000000*   - STOP RUN
000000*---------------------------------------------------------------*
000000* 13. デバッグ出力規約
000000*---------------------------------------------------------------*
000000* ・デバッグ出力は CST-DEBUG-MODE = 'Y' の場合のみ実行する
000000* ・DISPLAY-DETAIL-FUN001 / FUN002 に集約する
000000*---------------------------------------------------------------*
000000* 備考
000000*---------------------------------------------------------------*
000000* ・本コーディング規約は PGM001 SRC を正とする
000000* ・本規約は今後の類似バッチプログラムにも適用可能
000000*****************************************************************
